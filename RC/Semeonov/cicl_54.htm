<HTML><HEAD>
<!-- Meta http equivalent was here                                     -->
<META NAME="keywords" CONTENT="Циклы




">
<TITLE>5.4 Причины циклов пакетов и осцилляции маршрутов</TITLE>
</HEAD>
<BODY background="gainsboro" tppabs="http://book.itep.ru/gainsboro" link="#0000FF">

<center>
<table BORDER="0" CELLSPACING="1" CELLPADDING="5" bgcolor="ghostwhite">
  <tr>
    <td VALIGN="TOP" bgcolor="steelblue" LINK="#0000FF"><p align="center">

<A HREF="mod6_53.htm" tppabs="http://book.itep.ru/5/mod6_53.htm">  <IMG ALIGN=BOTTOM ALT="previous" SRC="k_prev.jpg" tppabs="http://book.itep.ru/k_prev.jpg"></A>


<A HREF="dia_5.htm" tppabs="http://book.itep.ru/5/dia_5.htm">   <IMG ALIGN=BOTTOM ALT="up"   SRC="k_up.jpg" tppabs="http://book.itep.ru/k_up.jpg"></A>


<A HREF="secur_6.htm" tppabs="http://book.itep.ru/6/secur_6.htm"><IMG ALIGN=BOTTOM ALT="down" SRC="k_down.jpg" tppabs="http://book.itep.ru/k_down.jpg"></A>


<A HREF="config55.htm" tppabs="http://book.itep.ru/5/config55.htm"><IMG ALIGN=BOTTOM ALT="next" SRC="k_next.jpg" tppabs="http://book.itep.ru/k_next.jpg"></A>

<A HREF="intro1.htm" tppabs="http://book.itep.ru/1/intro1.htm">  <IMG ALIGN=BOTTOM ALT="index" SRC="k_indx.jpg" tppabs="http://book.itep.ru/k_indx.jpg"></A>
<BR>

<B> <FONT COLOR="white">Previous: </FONT></B>
<A HREF="mod6_53.htm" tppabs="http://book.itep.ru/5/mod6_53.htm"><FONT COLOR="lightblue">5.3 Применение 6-го режима сетевого адаптера для     целей диагностики</FONT></A>


<B><FONT COLOR="white">&nbsp;&nbsp; UP:</FONT> </B>
<A HREF="dia_5.htm" tppabs="http://book.itep.ru/5/dia_5.htm"><FONT COLOR="lightblue">5 Диагностика локальных сетей и Интернет</FONT></A>
<BR>


<B><FONT COLOR="white"> Down:</FONT></B>
<A HREF="secur_6.htm" tppabs="http://book.itep.ru/6/secur_6.htm"><FONT COLOR="lightblue">6 Сетевая безопасность</FONT></A><BR>


<B><FONT COLOR="white">&nbsp; &nbsp; Next:</FONT></B>
<A HREF="config55.htm" tppabs="http://book.itep.ru/5/config55.htm"><FONT COLOR="lightblue">5.5 Конфигурирование сетевых систем</FONT></A>

</TD></TR>
<TR><TD ALIGN=CENTER>   
<FONT color="#0000FF" size=6><B>5.4 Причины циклов пакетов и осцилляции маршрутов</B></FONT><br>
<FONT size=3>Семенов Ю.А. (ГНЦ ИТЭФ)</FONT></p>

</TD></TR>
<TR><TD>
<!--new-->
<P ALIGN="JUSTIFY">Для рядового пользователя информация данного раздела не может представлять никакого интереса. Некоторые продвинутые пользователи иногда могут обратить внимание на то, что программа traceroute начинает (вместо нормального отображения пути до цели) выдавать попеременно имена двух соседних узлов. Это может позабавить, если конечно не влияет на решение 
пользователем его текущих задач. Но в любом случае вмешаться и исправить что-либо он не в силах. О причинах такого поведения сети можно прочесть в разделах, посвященных вопросам маршрутизации.</P>

<P ALIGN="justify">&#9;Начнем с локальных сетей. В разделе о мостах <a href="rep_4114.htm" tppabs="http://book.itep.ru/4/41/rep_4114.htm"> 4.1.1.4</a>, там где говорилось об алгоритме “расширяющееся дерево” отмечалась недопустимость того, чтобы две ЭВМ в локальной сети могли соединяться друг с другом различными путями. Здесь 
подразумевается соединение через систему мостов, повторителей/концентраторов и переключателей. Такого рода соединение через маршрутизаторы допустимо, но и там следует к этому относиться с определенной осторожностью. Рассмотрим фрагмент сети, изображенный на рис. 5.4.1.</p>

<p align="center"><img src="image610.gif" tppabs="http://book.itep.ru/5/image610.gif"></P>
<P ALIGN="CENTER">Рис. 5.4.1. Пример ошибочной топологии локальной сети</P>

<P ALIGN="JUSTIFY">&#9;Пакеты от машины 1 через концентратор 1 и 2 попадут в концентратор 2, эти же пакеты попадут туда через мост. В результате возникнет встречное кольцевое движение идентичных пакетов. Кроме того, переключатели и мост попытаются разобраться с этим безобразием и начнут посылать широковешательные пакеты, чтобы выяснить с каким из портов на самом деле связаны эти ЭВМ. Они от рождения убеждены, что одна и та же ЭВМ может быть доступна только через один порт. Таким образом, всплески загрузки сети, особенно широковещательной, должны привлекать внимание администратора. В данном примере, если система переключателей и мостов не поддерживает алгоритма 
“расширяющееся дерево”, администратор сам должен разорвать эту кольцевую структуру.</P>

<P ALIGN="JUSTIFY">&#9;Зацикливание пакетов возможно также при использовании внутреннего протокола маршрутизации IGRP, где некорректный выбор параметра <I>вариация</I> приводит к тому, что система при распределении потоков по нескольким направлениям воспринимает путь “назад”, как вполне приемлемый.</P>

<P ALIGN="JUSTIFY">&#9;Еще один вариант циклов пакетов возникает при использовании маршрутов по умолчанию (более детально это описано в разделе, посвященном маршрутизации <A HREF="rut_4411.htm" tppabs="http://book.itep.ru/4/44/rut_4411.htm">4.4.11</A>). Так при наличии канала между сетями А и Б внешние маршрутизаторы этих сетей сконфигурированы так, что в сети А пакет адресованный не А, направляется 
в Б, а в сети Б все пакеты с местом назначения не Б, направляются сети А. Такая конфигурация возможна и она будет работать нормально до тех пор, пока в одной из сетей не появится пакет с ошибочным адресом, не соответствующем ни сети А, ни Б. Такой пакет будет двигаться между сетями А и Б до тех пор пока не выработает свой ресурс по TTL.</P>

<P ALIGN="JUSTIFY">&#9;Похожие проблемы возникают при реализации, например, протокола маршрутизации RIP (см. раздел <A HREF="rip44111.htm" tppabs="http://book.itep.ru/4/44/rip44111.htm">4.4.11.1</A>), что сильно замедляет 
там процедуру установления равновесного маршрута.</P>

<P ALIGN="JUSTIFY">&#9;Протоколы маршрутизации работают с системами, где имеют место огромные задержки. И как всякая система управления с задержанной обратной связью такие системы склонны к осцилляциям. Допустим некоторый узел, оценив метрику нескольких маршрутов, принял решение перейти на новый маршрут. Если он это сделает, об этом окружающие маршрутизаторы узнают с заметной задержкой и соответствующим образом изменят свои оценки метрик фрагментов пути. Когда (снова с задержкой) исходный маршрутизатор получит информацию об этих оценкам, может случится, что старый маршрут окажется предпочтительнее нового, и все начнется сначала.</P>

<P ALIGN="JUSTIFY">&#9;Рассмотренные в данном разделе относительно экзотические явления (кроме примера из локальных сетей, здесь имеет место не экзотика, а стихийное бедствие) встречаются не так часто, но администратор сети должен принимать в расчет и такие возможности. Любой из упомянутых эффектов может сильно ухудшить эксплуатационные параметры сети, а то и вовсе вывести 
ее из строя.</P>






</TD></TR>

<TR bgcolor="steelblue"><TD VALIGN="TOP" bgcolor="steelblue" LINK="#0000FF"><P ALIGN="center">

<FONT color="white"><B> Previous: </B></FONT>
<A HREF="mod6_53.htm" tppabs="http://book.itep.ru/5/mod6_53.htm"><FONT COLOR="lightblue">5.3 Применение 6-го режима сетевого адаптера для     целей диагностики</FONT></A>



<FONT color="white"><B> &nbsp; &nbsp;UP:</B></FONT>
<A HREF="dia_5.htm" tppabs="http://book.itep.ru/5/dia_5.htm"><FONT COLOR="lightblue">5 Диагностика локальных сетей и Интернет</FONT></A>


<BR>

<FONT color="white"><B>  Down:</B></FONT>
<A HREF="secur_6.htm" tppabs="http://book.itep.ru/6/secur_6.htm"><FONT COLOR="lightblue">6 Сетевая безопасность</FONT></A>



<FONT color="white"><B> &nbsp; &nbsp;Next:</B></FONT>
<A HREF="config55.htm" tppabs="http://book.itep.ru/5/config55.htm"><FONT COLOR="lightblue">5.5 Конфигурирование сетевых систем</FONT></A>

</TD>
  </TR>
</table>
</BODY>
</HTML>