<HTML><HEAD>
<!-- Meta http equivalent was here                                     -->
<META NAME="keywords" CONTENT="fibre channel
fabric


">
<TITLE>4.1.12 Канальный протокол Fibre Channel</TITLE>
</HEAD>
<BODY background="gainsboro" tppabs="http://book.itep.ru/gainsboro" link="#0000FF">

<center>
<table BORDER="0" CELLSPACING="1" CELLPADDING="5" bgcolor="ghostwhite">
  <tr>
    <td VALIGN="TOP" bgcolor="steelblue" LINK="#0000FF"><p align="center">

<A HREF="bvg_4111.htm" tppabs="http://book.itep.ru/4/41/bvg_4111.htm">  <IMG ALIGN=BOTTOM ALT="previous" SRC="k_prev.jpg" tppabs="http://book.itep.ru/k_prev.jpg"></A>


<A HREF="eth_411.htm" tppabs="http://book.itep.ru/4/41/eth_411.htm">   <IMG ALIGN=BOTTOM ALT="up"   SRC="k_up.jpg" tppabs="http://book.itep.ru/k_up.jpg"></A>


<A HREF="apply_42.htm" tppabs="http://book.itep.ru/4/42/apply_42.htm"><IMG ALIGN=BOTTOM ALT="down" SRC="k_down.jpg" tppabs="http://book.itep.ru/k_down.jpg"></A>


<A HREF="smds.htm" tppabs="http://book.itep.ru/4/41/smds.htm"><IMG ALIGN=BOTTOM ALT="next" SRC="k_next.jpg" tppabs="http://book.itep.ru/k_next.jpg"></A>

<A HREF="intro1.htm" tppabs="http://book.itep.ru/1/intro1.htm">  <IMG ALIGN=BOTTOM ALT="index" SRC="k_indx.jpg" tppabs="http://book.itep.ru/k_indx.jpg"></A>
<BR>

<B> <FONT COLOR="white">Previous: </FONT></B>
<A HREF="bvg_4111.htm" tppabs="http://book.itep.ru/4/41/bvg_4111.htm"><FONT COLOR="lightblue">4.1.11 Сети 100Base-VG</FONT></A>


<B><FONT COLOR="white">&nbsp;&nbsp; UP:</FONT> </B>
<A HREF="eth_411.htm" tppabs="http://book.itep.ru/4/41/eth_411.htm"><FONT COLOR="lightblue">4.1.1 Ethernet (IEEE 802.3)</FONT></A>
<BR>


<B><FONT COLOR="white"> Down:</FONT></B>
<A HREF="apply_42.htm" tppabs="http://book.itep.ru/4/42/apply_42.htm"><FONT COLOR="lightblue">4.2 Наложенные сети</FONT></A><BR>


<B><FONT COLOR="white">&nbsp; &nbsp; Next:</FONT></B>
<A HREF="smds.htm" tppabs="http://book.itep.ru/4/41/smds.htm"><FONT COLOR="lightblue">4.1.13 Коммутируемая мультимегабитная информационная служба SMDS</FONT></A>

</TD></TR>
<TR><TD ALIGN=CENTER>   
<FONT color="#0000FF" size=6><B>4.1.12 Канальный протокол Fibre Channel</B></FONT><br>
<FONT size=3>Семенов Ю.А. (ГНЦ ИТЭФ)</FONT></p>

</TD></TR>
<TR><TD>
<!--new-->
<P ALIGN="JUSTIFY">Известно, что производительность микропроцессоров рабочих станций 
удваивается каждые 18 месяцев. Каждому миллиону операций в секунду процессора должна соответствовать 
пропускная способность ввода/вывода, равная мегабиту в секунду (<I>закон Amdahl</I>). По этой 
причине требования к широкополосности телекоммуникационных каналов уже сегодня лежит в диапазоне 
от 100 до 1000 Мбит/с. Наиболее популярные скоростные сети Fast Ethernet, FDDI и ATM соответствуют 
этим требованиям на пределе. Уже одно это заставляет обратить внимание на такие протоколы как 
гигабитный Ethernet и (стандарт ANSI). Fibre Channel сочетает в себе преимущества канальных и 
сетевых технологий. Работы по разработке стандарта FC начаты группой ANSI в 1988 году. К настоящему 
времени разработано более 20 регламентирующих документов. В настоящее время Fibre Channel 
конкурирует как с Ethernet, так и с SCSI. Смотри <A HREF="tppmsgs/msgs2.htm#249" tppabs="http://www.prz.tu-berlin.de/docs/html/EANTC/INFOSYS/fibrechannel/detail">
www.prz.tu-berlin.de/docs/html/EANTC/INFOSYS/fibrechannel/detail</A>,  
<A HREF="tppmsgs/msgs2.htm#250" tppabs="http://www.fibrechannel.com/technology/physical.htm">http://www.fibrechannel.com/technology/physical.htm</A> и
<A HREF="tppmsgs/msgs2.htm#251" tppabs="http://www.ancor.com/">http://www.ancor.com</A>. 
<A HREF="tppmsgs/msgs2.htm#252" tppabs="http://www.iol.unh.edu/training/fc/fc_tutorial.html">http://www.iol.unh.edu/training/fc/fc_tutorial.html</A>. 
Последний уже сейчас превосходит по 
быстродействию существующие сети в 10-100 раз. Он легко стыкуется с протоколами локальных и 
региональных сетей. Fibre Channel имеет уникальную систему физического интерфейса и форматы кадров, 
которые позволяют этому стандарту обеспечить простую стыковку с канальными протоколами IPI 
(Intelligent Peripheral Interface), SCSI, HIPPI, ATM, IP и 802.2. Это позволяет, например, 
организовать скоростной канал между ЭВМ и дисковой накопительной системой RAID. Быстродействие 
сетей Fibre Channel составляет n<FONT FACE="Symbol">ґ</FONT> 100Мбайт/с при длинах 
канала 10 км и более. Предусмотрена работа и на меньших скоростях (например, 12,5 Мбайт/c). 
Предельная скорость передачи составляет 4,25 Гбод. В качестве транспортной среды может использоваться 
одномодовое или мультимодовое оптическое волокно. Допускается применение медного коаксиального 
кабеля и скрученных пар (при скоростях до 200 Мбайт/с). Fibre Channel имеет шесть независимых 
классов услуг (каждый класс представляет определенную стратегию обмена информацией), которые 
облегчают решать широкий диапазон прикладных задач:</P>

<CENTER> <TABLE CELLSPACING=0 BORDER=0 CELLPADDING=2 WIDTH=800>
<TR><TD WIDTH="13%" valign="top"><p align="justify">Класс 1</td>
<td width="87%" valign="top">
<p align="justify">Соединение с коммутацией каналов по схеме точка-точка (end-to-end) между 
портами типа n_port Класс удобен для аудио и видео приложений, например, видеоконференций. После 
установления соединения используется вся доступная полоса пропускания канала. При этом 
гарантируется, что кадры будут получены в том же порядке, в каком они были посланы.</td>
</tr>
<tr><td width="13%" valign="top"><p align="justify">Класс 2</td>
<td width="87%" valign="top"><p align="justify">Обмен без установления соединения с коммутацией 
пакетов, гарантирующий доставку данных. Так как соединение не устанавливается, порт может 
взаимодействовать одновременно с любым числом портов типа n_port, получая и передавая кадры. 
Здесь не может быть гарантии того, что кадры будут доставлены в том же порядке, в каком были 
переданы, (за исключением случаев соединения точка-точка или арбитражное кольцо). В этом классе 
допустимы схемы управления потоком буфер-буфер и точка-точка. Этот класс характерен для локальных 
сетей, где время доставки данных не является критическим.</td>
</tr>
<tr><td width="13%" valign="top"><p align="justify">Класс 3</td>
<td width="87%" valign="top"><p align="justify">Обмен дейтограммами без установления соединения и 
без гарантии доставки. Схема управления потоком буфер-буфер. Применяется для каналов scsi.</td>
</tr>
<tr><td width="13%" valign="top"><p align="justify">Класс 4</td>
<td width="87%" valign="top"><p align="justify">Обеспечивает выделение определенной доли пропускной 
способности канала с заданным значением качества обслуживания (QoS). Работает только с топологией 
структура (fabric), где соединяются два порта типа n_port. При этом формируется два виртуальных 
соединения, обслуживающих встречные потоки данных. Пропускная способность этих соединения может 
быть различной. Как и в классе 1, здесь гарантируется порядок доставки кадров. Допускается 
одновременное соединение более чем с одним портом типа n_port. Используется схема управления 
потоком буфер-буфер. Каждое виртуальное соединение управляется независимо с помощью сигнала-примитива 
fc_rdy.</td>
</tr>
<tr><td width="13%" valign="top"><p align="justify">Класс 5</td>
<td width="87%" valign="top"><p align="justify">Предполагает изохронное обслуживание. Регламентирующие документы 
находятся в процессе подготовки. </td>
</tr>
<tr><td width="13%" valign="top"><p align="justify">Класс 6</td>
<td width="87%" valign="top"><p align="justify">Предусматривает мультикастинг-обслуживание в 
рамках топологии типа структура (fabric). При этом используется стандартный адрес 0xfffff5. n_port 
становится членом мультикаст-группы путем регистрации по адресу 0xfffff8.</td>
</tr>
</table></center> 

<p align="justify">fibre channel использует пакеты переменной длины (до 2148 байт), содержащие 
до 2112 байт данных. Такая длина пакета заметно снижает издержки, связанные с пересылкой заголовков 
(эффективность 98%). С этой точки зрения в наихудшем положении оказывается ATM(83% эффективность 
48 байт данных при 53 байтном пакете). Только FDDI превосходит Fibre Channel по этому параметру 
(99%). В отличие от других локальных сетей, использующих 6-октетные адреса, fibre channel работает 
с 3-байтовыми адресами, распределяемыми динамически в процессе выполнения операции login. Адрес 
0xffffff зарезервирован для широковещательной адресации. Адреса же в диапазоне 0xfffff0-0xfffffe 
выделены для обращения к "структуре" (fabric), мультикастинг-серверу и серверу псевдонимов 
(alias-server). n_port передает кадры от своего source_id (s_id) к destination_id (d_id). До 
выполнения операции fabric login s_id порта не определено. В случае арбитражного кольца применяются 
3-октетные адреса al_pa, задаваемые при инициализации кольца. Для однозначной идентификации узлов используются 64-битовые имена-идентификаторы.</p> 

<p align="justify">Fibre Channel превосходит другие сети и по некоторым экономическим параметрам (см. табл. 4.1.12.1). </p>
<p align="center">Таблица 4.1.12.1 (www.ancor.com/ctspr97.htm<sup> </sup>) </p>
<center> <table border=10 cellspacing=1 cellpadding=5 width=436 bgcolor="ghostwhite">
<tr><td width="38%" valign="top" bgcolor="gainsboro"><b><p align="justify">Сеть</b></td>
<td width="62%" valign="top" bgcolor="gainsboro"><b><p align="justify">Стоимость за Мбит/сек</b></td>
</tr>
<tr><td width="38%" valign="top" height=4><p align="justify">fddi</td>
<td width="62%" valign="top" height=4><p align="justify">109,1$ США</td>
</tr>
<tr><td width="38%" valign="top"><p align="justify">Fast Ethernet</td>
<td width="62%" valign="top"><p align="justify">12,8 $</td>
</tr>
<tr><td width="38%" valign="top"><p align="justify">ATM</td>
<td width="62%" valign="top"><p align="justify">23,8$</td>
</tr>
<tr><td width="38%" valign="top"><p align="justify">Fibre Channel</td>
<td width="62%" valign="top"><p align="justify">9,5$</td>
</tr>
</table></center> 

<p align="justify">Цены вещь непостоянная, но здесь следует учитывать относительный их характер, да и в случае начала массового производства цены на fibre channel пожалуй будут падать быстрее, чем для других сетей (они этот этап уже прошли).</p>

<p align="justify">Формат пакетов в сетях Fibre Channel показан на рис. 4.1.12.1. Здесь 
используются 24-битовые адреса, что позволяет адресовать до 16 миллионов объектов. Сеть может 
строить соединения по схеме точка-точка, допускается и кольцевая архитектура с возможностью 
арбитража (FC-al) и другие схемы (например, “ткань соединений” (fabric), допускающее большое число 
независимых обменов одновременно). Схема кольцевого соединения показана на рис. 4.1.12.2. 
К кольцу может быть подключено до 128 узлов. Протокол Fibre Channel предусматривает 5 уровней, 
которые определяют физическую среду, скорости передачи, схему кодирования, форматы пакетов, 
управление потоком и различные виды услуг. На физическом уровне (FC-ph 1993 год) предусмотрены 
три подуровня. FC использует оптические волокна диаметром 62,5, 50мкм и одномодовые. Для обеспечения 
безопасности предусмотрен опционный контроль подключенности оптического разъема (OFC). Для этого 
передатчик время от времени посылает короткие световые импульсы приемнику. Если приемник получает такой импульс, процесс обмена продолжается.</p>

<p align="justify"><b> FC-0 </b> определяет физические характеристики интерфейса и среды, включая 
кабели, разъемы, драйверы (ECL, LED, лазеры), передатчики и приемники. Вместе с FC-1 этот уровень 
образует физический слой.<br>
<b> FC-1 </b> определяет метод кодирования/декодирования (8B/10B) и протокол передачи, где 
объединяется пересылка данных и синхронизирующей информации.<br>
<b> FC-2 </b> определяет правила сигнального протокола, классы услуг, топологию, методику сегментации, 
задает формат кадра и описывает передачу информационных кадров.<br>
<b> FС-3 </b> определяет работу нескольких портов на одном узле и обеспечивает общие виды сервиса.<br>
<b> FC-4 </b> обеспечивает реализацию набора прикладных команд и протоколов вышележащего уровня 
(например, для SCSI, IPI, IEEE 802, SBCCS, HIPPI, IP, ATM и т.д.)</p>
<p align="justify"> FC-0 и FC-1 образуют физический уровень, соответствующей стандартной модели ISO. </P>

<p align="center"><img src="image216.gif" tppabs="http://book.itep.ru/4/41/image216.gif"></p>
<p align="center">Рис. 4.1.12.1. Формат пакета Fibre Channel</p>

<p align="justify">Стандарт FC допускает соединение типа точка-точка, арбитражное кольцо и структура (верх, середина и низ рисунка 4.1.12.2). Кольцевая архитектура обеспечивает самое дешевое подключение. Система арбитража допускает обмен только между двумя узлами одновременно. Следует учесть, что 
кольцевая структура не предполагает применения маркерной схемы доступа. Когда подключенное к сети устройство готово передать данные, он передает сигнал-примитив ARBX, где X - физический адрес устройства в кольце арбитража (al_pa). Если устройство получит свой собственный сигнал-примитив ARBX, оно получает контроль над кольцом и может начать передачу. Инициатор обмена посылает 
сигнал-примитив open (OPN) и устанавливает связь с адресатом. Время удержания контроля над кольцом не лимитируется. Если контроль над кольцом одновременно пытаются захватить два устройства, сравниваются значения X сигналов ARB. Устройство с меньшим al_pa получает преимущество, прибор с большим al_pa блокируется.</p>

<p align="justify">Прежде чем использовать кольцо его нужно инициализировать (процедура LIP), так чтобы каждый порт получил свой физический адрес (al_pa - один октет, что и определяет макcимальное число портов в кольце арбитража). Процедура инициализации начинается сразу после включения питания 
посылкой сигнала-примитива LIP через порт l_port. Затем осуществляется выбор устройства, которое будет управлять процессом выбора al_pa.</p>

<p align="center"><img src="image217.gif" tppabs="http://book.itep.ru/4/41/image217.gif"></P>
<P ALIGN="CENTER">Рис. 4.1.12.2. Типы топологии FC</P>

<P ALIGN="JUSTIFY">Перед передачей октеты преобразуются в 10-битовые кодовые последовательности, 
называемые символами передачи (кодировка IBM 8B/10B). Логической единице соответствует больший 
уровень световой энергии. В Fibre Channel предусмотрено два режима 
обмена буфер-буфер и точка-точка (end-to-end). Передача данных осуществляется только когда 
принимающая сторона готова к этому. Прежде чем что-либо посылать стороны должны выполнить 
операцию login. В ходе выполнения login определяется верхний предел объема пересылаемых данных 
(credit). Значение параметра credit задает число кадров, которые могут быть приняты. После передачи 
очередного кадра значение credit уменьшается на единицу. Когда значение этой переменной достигает 
нуля, дальнейшая передача блокируется до тех пор, пока получатель не обработает один или более 
кадров и будет готов продолжить прием. Здесь имеет место довольно тесная аналогия с окнами в 
протоколе TCP. Режим обмена буфер-буфер предполагает установление связи между портами N_Port и 
F_Port или между двумя N_Port. При установлении соединения каждая из сторон сообщает партнеру, 
сколько кадров она готова принять (значение переменной BB_Credit). Режим точка-точка (end-to-end) 
реализуется между портами типа N_Port. Предельное число кадров, которые сторона может принять, 
задается переменной EE_Credit. Эта переменная устанавливается равной нулю при инициализации, 
увеличивается на единицу при передаче кадра и уменьшается при получении кадра ACK Link Control. 
Кадр ACK может указывать на то, что порт получил и обработал один кадр, N кадров или всю 
последовательность кадров. Смотри также "Definitions of Managed Objects for the Fabric Element 
in Fibre Channel Standard". K. Teow. May 2000, RFC-2837. </P>





</TD></TR>

<TR bgcolor="steelblue"><TD VALIGN="TOP" bgcolor="steelblue" LINK="#0000FF"><P ALIGN="center">

<FONT color="white"><B> Previous: </B></FONT>
<A HREF="bvg_4111.htm" tppabs="http://book.itep.ru/4/41/bvg_4111.htm"><FONT COLOR="lightblue">4.1.11 Сети 100Base-VG</FONT></A>



<FONT color="white"><B> &nbsp; &nbsp;UP:</B></FONT>
<A HREF="eth_411.htm" tppabs="http://book.itep.ru/4/41/eth_411.htm"><FONT COLOR="lightblue">4.1.1 Ethernet (IEEE 802.3)</FONT></A>


<BR>

<FONT color="white"><B>  Down:</B></FONT>
<A HREF="apply_42.htm" tppabs="http://book.itep.ru/4/42/apply_42.htm"><FONT COLOR="lightblue">4.2 Наложенные сети</FONT></A>



<FONT color="white"><B> &nbsp; &nbsp;Next:</B></FONT>
<A HREF="smds.htm" tppabs="http://book.itep.ru/4/41/smds.htm"><FONT COLOR="lightblue">4.1.13 Коммутируемая мультимегабитная информационная служба SMDS</FONT></A>

</TD>
  </TR>
</table>
</BODY>
</HTML>